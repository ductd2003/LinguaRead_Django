{% load static %}
<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Khám phá bài viết học ngôn ngữ (Anh, Trung, Nhật ...) với các cấp độ từ cơ bản đến nâng cao. Kiểm tra kiến thức của bạn qua câu hỏi sau mỗi bài đọc và cải thiện kỹ năng ngay hôm nay!" />
    <title>Responsive Blog Template</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      /* General Styles */
body {
  font-family: "Roboto", sans-serif;
  margin: 0;
  padding: 0;
  background: #f7f8fc; /* Nền màu xám nhạt */
  min-height: 100vh; /* Chiều cao tối thiểu bằng chiều cao của màn hình */
  display: flex;
  flex-direction: column; /* Đặt các phần tử con theo cột */
}


header {
  background: linear-gradient(135deg, #182848, #4b6cb7);
  color: #fff;
  padding: 15px 0;
  position: fixed;
  width: 100%;
  z-index: 1001;
  top: 0;
  left: 0;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

header .container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header .logo {
  font-size: 1.7rem;
  font-weight: bold;
  color: #ffa500;
  cursor: pointer;
  user-select: none;
}

.menu-toggle {
  background: none;
  border: none;
  color: #ffa500;
  font-size: 1.7rem;
  cursor: pointer;
}

.nav-links {
  position: fixed;
  top: 0;
  right: -100%;
  width: 300px;
  height: 100%;
  background: linear-gradient(135deg, #4b6cb7, #182848);
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 20px;
  transition: right 0.4s ease-in-out;
  z-index: 1000;
  box-shadow: -4px 0 6px rgba(0, 0, 0, 0.2);
}

.nav-links.active {
  right: 0;
}

.nav-links ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.nav-links ul li {
  margin-bottom: 20px;
}

.nav-links ul li a {
  color: #fff;
  text-decoration: none;
  font-size: 1.3rem;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: transform 0.2s ease, color 0.3s ease;
}

.nav-links ul li a:hover {
  transform: scale(1.05);
  color: #ffa500;
}

/* Overlay */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.4s ease-in-out;
  z-index: 999;
}

.overlay.active {
  opacity: 1;
  visibility: visible;
}

footer {
  width: 100%; /* Đảm bảo footer bao phủ toàn bộ chiều ngang */
  text-align: center;
  padding: 15px;
  background: #4b6cb7;
  color: #fff;
  box-sizing: border-box; /* Tính toán đúng kích thước khi thêm padding */
}

.layout {
  display: flex;
  flex: 1;
  margin-top: 80px;
}

/* Nội dung chính */
main {
  flex: 1;
}

/* Search and Filter Section */
.search-filter {
  display: flex;
  flex-direction: column; /* Sắp xếp các hàng theo chiều dọc */
  gap: 15px; /* Tạo khoảng cách giữa các hàng */
  margin: 20px 0;
  padding: 15px;
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Filter Row (2 bộ lọc trên cùng một hàng) */
.filter-row {
  display: flex;
  gap: 15px; /* Khoảng cách giữa các bộ lọc */
}

.filter select {
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ddd;
  width: 100%; /* Đảm bảo các bộ lọc có kích thước đồng đều */
}

/* Search Bar (nằm dưới cùng) */
.search-bar {
  display: flex;
  gap: 10px;
}

.search-bar input {
  flex: 1; /* Thanh tìm kiếm chiếm tối đa không gian */
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ddd;
}

.search-bar button {
  background: #4b6cb7;
  color: #fff;
  padding: 10px 15px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background 0.3s ease;
}

.search-bar button:hover {
  background: #182848;
}

/* Blog List */
.blog-list .section-title {
  font-size: 2rem;
  color: #4b6cb7;
  text-align: center;
  margin-bottom: 30px;
}

.blog-item {
  display: flex;
  align-items: center;
  gap: 20px;
  background: #ffffff; /* Nền bài viết vẫn trắng để nổi bật nội dung */
  border-radius: 10px;
  padding: 15px;
  margin-bottom: 20px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  cursor: pointer;
}

.blog-item:hover {
  transform: scale(1.02);
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
}

.container {
  width: 90%;
  max-width: 900px;
  margin: auto;
}

.image-container {
  width: 100px;
  height: 100px;
  position: relative;
}

.image-container img {
  width: 100%;
  height: 100%;
  border-radius: 10px;
  object-fit: cover;
}

.blog-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.title-and-meta h3 {
  font-size: 1.2rem;
  margin: 0 0 5px;
  color: #333;
}

.meta {
  font-size: 0.9rem;
  color: #666;
}

.share-container {
  margin-top: 10px;
}

.share-btn {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: 0.9rem;
  color: #4b6cb7;
  text-decoration: none;
  background: #f0f0f0;
  padding: 5px 10px;
  border-radius: 5px;
  transition: background 0.3s ease, color 0.3s ease;
}

.share-btn:hover {
  background: #4b6cb7;
  color: #fff;
}

/* Pagination */
.pagination {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}

.pagination .page {
  padding: 10px 15px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 5px;
  text-decoration: none;
  color: #4b6cb7;
  transition: background 0.3s ease, color 0.3s ease;
}

.pagination .page.active {
  background: #4b6cb7;
  color: #fff;
}

.pagination .page:hover {
  background: #ffa500;
  color: #fff;
}

@media (max-width: 992px) {
  .search-filter {
    flex-direction: column; /* Đổi bố cục từ ngang sang dọc */
    align-items: flex-start; /* Canh các phần tử sang trái */
  }

  .search-bar {
    width: 100%; /* Đảm bảo thanh tìm kiếm chiếm toàn bộ chiều ngang */
  }

  .blog-item {
    flex-direction: column; /* Chuyển thành cột khi trên mobile */
    align-items: flex-start;
    text-align: center;
  }

  .image-container {
    width: 100%; /* Chiều rộng 100% để ảnh căn giữa */
    height: auto;
    display: flex;
    justify-content: center;
  }

  .image-container img {
    width: 80%; /* Giữ kích thước phù hợp trên mobile */
    max-width: 150px; /* Giới hạn kích thước tối đa */
    height: auto;
  }

  .blog-info {
    width: 100%;
  }

  .title-and-meta h3 {
    font-size: 1.1rem;
  }

  .meta {
    font-size: 0.8rem;
  }
}

a {
  text-decoration: none; /* Bỏ gạch chân */
  color: inherit; /* Giữ lại màu chữ của phần tử cha */
}

    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container">
        <div class="logo">
          <a href="/"><i class="fa-brands fa-readme"></i> LinguaRead</a>
        </div>
        <button class="menu-toggle" aria-label="Toggle menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </header>

    <!-- Sidebar Menu -->
    <nav class="nav-links">
      <ul>
        <li>
          <a href="{% url 'list-posts' %}"><i class="fas fa-home"></i> Trang chủ</a>
        </li>
        {% comment %} <li>
          <a href="#"><i class="fa-solid fa-folder"></i> Thẻ ghi nhớ</a>
        </li> {% endcomment %}
        <li>
          <a href="{% url 'about_us' %}" ><i class="fas fa-info-circle"></i> Giới thiệu</a>
        </li>
      </ul>
    </nav>

    <div class="loading-spinner" id="loading-spinner"></div>

    <!-- Overlay -->
    <div class="overlay"></div>

    <!-- Layout chính với Sidebar -->
    <div class="layout">
      <!-- Nội dung chính -->
      <main>
        <div class="container">
          <!-- Search and Filter -->
          <form method="get">
            <div class="search-filter">
              <div class="filter-row">
                <div class="filter">
                  <select name="levelId" id="levelId" class="form-control">
                    {% for level in levels %}
                    <option value="{{ level.levelid }}" {% if selected_level == level.levelid %}selected{% endif %}>
                        {{ level.levelname }}
                    </option>
                    {% endfor %}
                  </select>
                </div>
  
                <div class="filter">
                  <select name="languageId" id="languageId" class="form-control">
                    {% for language in languages %}
                    <option value="{{ language.languageid }}" {% if selected_language == language.languageid %}selected{% endif %}>
                        {{ language.languagename }}
                    </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="search-bar">
                <input type="text" name="search" id="search" class="form-control" placeholder="Search by title" value="{{ search }}">
                <button type="submit" ><i class="fas fa-search"></i></button>
              </div>
            </div>
          </form>

          <!-- Blog List -->
          <section class="blog-list">
            <h2 class="section-title">Danh sách bài viết</h2>

            {% for post in page_obj %}
            <div class="blog-item" onclick="handleDivClick({{ post.postid }}, {{ selected_level }}, {{ selected_language }})">
              <div class="image-container">
                <img src="data:image/png;base64,{{ post.image }}" alt="Blog Image" />
              </div>
              <div class="blog-info">
                <div class="title-and-meta">
                  <h3>
                    {{ post.selected_postcontent.title|truncatewords:10 }}
                  </h3>
                  {{ post.selected_postcontent.content|truncatechars:100|safe }}
                  <p class="meta">
                    <i class="fas fa-clock"></i> {{ post.createdat|date:"j/n/Y" }}
                  </p>
                </div>
              </div>
            </div>
            {% endfor %}

            
          </section>

          <!-- Pagination -->
          <div class="pagination">
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}&levelId={{ selected_level }}&languageId={{ selected_language }}&search={{ search }}" class="page">
                Trước
            </a>
            {% endif %}
        
            <!-- Hiển thị trang đầu -->
            {% if page_obj.number > 3 %}
            <a href="?page=1&levelId={{ selected_level }}&languageId={{ selected_language }}&search={{ search }}" class="page">1</a>
            <span class="page">...</span>
            {% endif %}
        
            <!-- Hiển thị các trang xung quanh trang hiện tại -->
            {% for num in page_obj.paginator.page_range %}
            {% if num >= page_obj.number|add:'-2' and num <= page_obj.number|add:'2' %}
            <a href="?page={{ num }}&levelId={{ selected_level }}&languageId={{ selected_language }}&search={{ search }}" class="page {% if page_obj.number == num %}active{% endif %}">
                {{ num }}
            </a>
            {% endif %}
            {% endfor %}
        
            <!-- Hiển thị trang cuối -->
            {% if page_obj.number < page_obj.paginator.num_pages|add:'-2' %}
            <span class="page">...</span>
            <a href="?page={{ page_obj.paginator.num_pages }}&levelId={{ selected_level }}&languageId={{ selected_language }}&search={{ search }}" class="page">
                {{ page_obj.paginator.num_pages }}
            </a>
            {% endif %}
        
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}&levelId={{ selected_level }}&languageId={{ selected_language }}&search={{ search }}" class="page">
                Tiếp
            </a>
            {% endif %}
        </div>        
        
        </div>
      </main>
    </div>

    <footer>
      <p>&copy; 2024 Blog Template - Tất cả quyền được bảo vệ.</p>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".menu-toggle");
        const navLinks = document.querySelector(".nav-links");
        const overlay = document.querySelector(".overlay");
    
        // Toggle menu khi nhấn nút hamburger
        menuToggle.addEventListener("click", () => {
            navLinks.classList.toggle("active");
            overlay.classList.toggle("active");
        });
    
        // Ẩn menu khi nhấn overlay
        overlay.addEventListener("click", () => {
            navLinks.classList.remove("active");
            overlay.classList.remove("active");
        });
    });
    </script>
    <script>
      function handleDivClick(postId, levelId, languageId) {
        const url = `/user/post-detail/?postId=${postId}&levelId=${levelId}&languageId=${languageId}`; // Tạo URL với các tham số
        window.location.href = url; // Chuyển hướng
      }
    </script>
    
    
  </body>
</html>
